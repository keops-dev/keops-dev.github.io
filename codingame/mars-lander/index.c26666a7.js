function t(t){return t&&t.__esModule?t.default:t}let e=function*(t){const e=t.split("\n");for(ligne of e)yield ligne}(t("2500 2700 550\n7\n0 100\n1000 500\n1500 1500\n3000 1000\n4000 150\n5500 150\n6999 800"));function n(){return e.next().value}function s(t){const e=function(){const t=document.getElementById("mars_bg");if(null==t||!(t instanceof HTMLCanvasElement))throw new Error("L'élément sélectionné n'existe pas ou n'est pas un canvas ([id='mars_bg'])");return t.getContext("2d")}();if(e){e.save(),e.translate(0,3e3),e.scale(1,-1),e.beginPath(),e.moveTo(0,0),e.lineTo(0,t[0].y);for(const n of t)e.lineTo(n.x,n.y);e.lineTo(7e3,0),e.fillStyle="rgb(146, 53, 53)",e.fill(),e.restore()}}function o(t,e){const n=function(){const t=document.getElementById("animation");if(null==t||!(t instanceof HTMLCanvasElement))throw new Error("L'élément sélectionné n'existe pas ou n'est pas un canvas ([id='animation'])");return t.getContext("2d")}();n?.save(),n?.translate(0,3e3),n?.scale(1,-1),n.fillStyle="rgb(245, 42, 76)",n?.fillRect(t.x-5,t.y-5,10,10),n.fillStyle="#fff",n?.fillRect(2495,1162,10,10);const s=document.getElementById("mars_bg")?.getBoundingClientRect(),o=document.getElementById("mars_lander"),r=Math.round(t.x/7e3*s.width),i=Math.round(t.y/3e3*s.height);o.style.transform=`translate(${r}px, ${-i}px) rotate(${-e}deg)`,n?.restore()}const r=document.getElementById("game_data"),i=document.getElementById("time_value"),a=document.getElementById("altitude_value"),l=document.getElementById("position_value"),d=document.getElementById("fuel_value"),u=document.getElementById("horizontal_speed_value"),h=document.getElementById("vertical_speed_value");if(null==r)throw new Error("La div gameDataDiv n'a pas été trouvée");class c{hSpeed=0;vSpeed=0;rotate=-5;power=0;requestedPower=3;constructor(t,e){this.pos=t,this.fuel=e}}const p=document.getElementById("mars");p.height=3e3,p.width=7e3;const y=n().split(" "),m={pos:{x:parseInt(y[0]),y:parseInt(y[1])},fuel:parseInt(y[2])},g=parseInt(n()),x=[...Array(g).keys()].map((t=>{const e=n().split(" ");return{x:parseInt(e[0]),y:parseInt(e[1])}})),f=new class{gravity=3.711;timer=0;constructor(t,e){this.height=t,this.width=e,this.doTurn=this.doTurn.bind(this)}init(t,e){this.surfaces=t,this.ground=[{x:0,y:0},...t,{x:this.width,y:0}],this.lander=new c(e.pos,e.fuel),this.drawGround(),this.draw()}start(){this.doTurn()}intersectSegment(t,e,n,s){const o={x:0,y:0},r={x:0,y:0};o.x=e.x-t.x,o.y=e.y-t.y,r.x=s.x-n.x,r.y=s.y-n.y;const i=o.x*r.y-o.y*r.x;if(0===i)return;const a=-(t.x*r.y-n.x*r.y-r.x*t.y+r.x*n.y)/i;if(a<0||a>=1)return;const l=-(-o.x*t.y+o.x*n.y+o.y*t.x-o.y*n.x)/i;if(l<0||l>=1)return;return{x:n.x+l*r.x,y:t.y+a*o.y}}collision(t,e){const n=t.length,s={x:0,y:0};s.x=e.x,s.y=1e4+Math.random()%100;const o=[];for(let r=0;r<n;r++){const i=t[r];let a;a=r==n-1?t[0]:t[r+1];const l=this.intersectSegment(i,a,s,e);l&&o.push(l)}return o.length%2==1?(console.log("COLLISION avec pour pos",o[0]),o[0]):void 0}doTurn(){this.timer+=1,this.updateLander();const t=this.collision(this.ground,this.lander.pos);t?this.lander.pos=t:setTimeout((()=>window.requestAnimationFrame(this.doTurn)),1e3/120),this.draw(),this.updateDataUList()}updateLander(){const t=this.lander;this.lander.power=t.power===t.requestedPower?t.power:t.power+(t.requestedPower>t.power?1:-1);const e=Math.cos(this.lander.rotate*Math.PI/180)*this.lander.power,n=-Math.sin(this.lander.rotate*Math.PI/180)*this.lander.power;console.log("poussée",n.toString(),e.toString()),console.log("test",parseFloat(n.toFixed(3))),this.lander.vSpeed+=parseFloat((-this.gravity+e).toFixed(3)),this.lander.hSpeed+=parseFloat(n.toFixed(3)),this.lander.pos.x+=this.lander.hSpeed,this.lander.pos.y+=this.lander.vSpeed,console.log(JSON.stringify(this.lander))}updateDataUList(){i.textContent=this.timer.toString(),a.textContent=this.lander.pos.y.toString(),l.textContent=this.lander.pos.x.toString(),d.textContent=this.lander.fuel.toString(),u.textContent=this.lander.hSpeed.toString(),h.textContent=this.lander.vSpeed.toString()}drawGround(){s(this.surfaces)}draw(){o(this.lander.pos,this.lander.rotate)}playTurn(){}}(3e3,7e3);f.init(x,m),f.start();document.getElementById("mars");
//# sourceMappingURL=index.c26666a7.js.map
